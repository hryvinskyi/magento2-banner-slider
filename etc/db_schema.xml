<?xml version="1.0"?>
<!--
  ~ Copyright (c) 2025. Volodymyr Hryvinskyi. All rights reserved.
  ~ @author: <mailto:volodymyr@hryvinskyi.com>
  -->
<schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd">

    <!-- Main Slider Table -->
    <table name="hryvinskyi_banner_slider" resource="default" engine="innodb" comment="Banner Slider Table">
        <column xsi:type="int" name="slider_id" unsigned="true" nullable="false" identity="true"
                comment="Slider ID"/>
        <column xsi:type="varchar" name="name" nullable="false" length="255" comment="Slider Name"/>
        <column xsi:type="smallint" name="status" unsigned="true" nullable="false" default="1"
                comment="Status (0=Disabled, 1=Enabled)"/>
        <column xsi:type="varchar" name="location" nullable="true" length="255" comment="Location Identifier"/>
        <column xsi:type="varchar" name="store_ids" nullable="true" length="255" comment="Store IDs"/>
        <column xsi:type="varchar" name="customer_group_ids" nullable="true" length="255" comment="Customer Group IDs"/>
        <column xsi:type="int" name="priority" unsigned="true" nullable="false" default="0"
                comment="Priority for Ordering"/>
        <column xsi:type="varchar" name="effect" nullable="true" length="100" comment="Animation Effect"/>
        <column xsi:type="boolean" name="auto_width" nullable="false" default="false" comment="Auto Width Enabled"/>
        <column xsi:type="boolean" name="auto_height" nullable="false" default="false" comment="Auto Height Enabled"/>
        <column xsi:type="boolean" name="loop" nullable="false" default="true" comment="Loop Enabled"/>
        <column xsi:type="boolean" name="lazy_load" nullable="false" default="true" comment="Lazy Load Enabled"/>
        <column xsi:type="boolean" name="auto_play" nullable="false" default="true" comment="Autoplay Enabled"/>
        <column xsi:type="int" name="auto_play_timeout" unsigned="true" nullable="false" default="5000"
                comment="Autoplay Timeout in Milliseconds"/>
        <column xsi:type="boolean" name="nav" nullable="false" default="true" comment="Navigation Arrows Enabled"/>
        <column xsi:type="boolean" name="dots" nullable="false" default="true" comment="Pagination Dots Enabled"/>
        <column xsi:type="boolean" name="is_responsive" nullable="false" default="true"
                comment="Responsive Mode Enabled"/>
        <column xsi:type="text" name="responsive_items" nullable="true"
                comment="Responsive Breakpoints Configuration (JSON)"/>
        <column xsi:type="smallint" name="preload_banners_count" unsigned="true" nullable="false" default="0"
                comment="Number of First Banners to Preload Images"/>
        <column xsi:type="datetime" name="from_date" nullable="true" comment="Active From Date"/>
        <column xsi:type="datetime" name="to_date" nullable="true" comment="Active To Date"/>
        <column xsi:type="text" name="custom_css" nullable="true" comment="Custom CSS Styles"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Created At"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Updated At"/>

        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="slider_id"/>
        </constraint>

        <index referenceId="HRYVINSKYI_BANNER_SLIDER_STATUS" indexType="btree">
            <column name="status"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_LOCATION" indexType="btree">
            <column name="location"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_PRIORITY" indexType="btree">
            <column name="priority"/>
        </index>
    </table>

    <!-- Main Banner Table -->
    <table name="hryvinskyi_banner_slider_banner" resource="default" engine="innodb" comment="Banner Table">
        <column xsi:type="int" name="banner_id" unsigned="true" nullable="false" identity="true"
                comment="Banner ID"/>
        <column xsi:type="int" name="slider_id" unsigned="true" nullable="false" comment="Slider ID"/>
        <column xsi:type="varchar" name="name" nullable="true" length="255" comment="Banner Name"/>
        <column xsi:type="smallint" name="status" unsigned="true" nullable="false" default="1"
                comment="Status (0=Disabled, 1=Enabled)"/>
        <column xsi:type="smallint" name="type" unsigned="true" nullable="false" default="0"
                comment="Banner Type (0=Image, 1=Video, 2=Custom)"/>
        <column xsi:type="text" name="content" nullable="true" comment="Custom HTML Content"/>
        <column xsi:type="varchar" name="image" nullable="true" length="255" comment="Desktop Image Path"/>
        <column xsi:type="varchar" name="video_url" nullable="true" length="500"
                comment="External Video URL (YouTube, Vimeo)"/>
        <column xsi:type="varchar" name="video_aspect_ratio" nullable="true" length="20" default="16:9"
                comment="Video Aspect Ratio"/>
        <column xsi:type="varchar" name="video_path" nullable="true" length="255"
                comment="Local Video File Path"/>
        <column xsi:type="boolean" name="video_as_background" nullable="false" default="false"
                comment="Play Video as Background (autoplay, loop, muted, no controls)"/>
        <column xsi:type="varchar" name="link_url" nullable="true" length="500" comment="Banner Link URL"/>
        <column xsi:type="varchar" name="title" nullable="true" length="255" comment="Title/Alt Text"/>
        <column xsi:type="boolean" name="open_in_new_tab" nullable="false" default="true"
                comment="Open Link in New Tab"/>
        <column xsi:type="datetime" name="from_date" nullable="true" comment="Active From Date"/>
        <column xsi:type="datetime" name="to_date" nullable="true" comment="Active To Date"/>
        <column xsi:type="int" name="position" unsigned="true" nullable="false" default="0"
                comment="Display Position"/>
        <column xsi:type="boolean" name="is_preload" nullable="false" default="false"
                comment="Preload Image in Head"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="true" comment="Created At"/>
        <column xsi:type="timestamp" name="updated_at" on_update="false" nullable="true" comment="Updated At"/>

        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="banner_id"/>
        </constraint>

        <constraint xsi:type="foreign" referenceId="HRYVINSKYI_BANNER_SLIDER_BANNER_SLIDER_ID"
                    table="hryvinskyi_banner_slider_banner" column="slider_id"
                    referenceTable="hryvinskyi_banner_slider" referenceColumn="slider_id"
                    onDelete="CASCADE"/>

        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BANNER_SLIDER_ID" indexType="btree">
            <column name="slider_id"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BANNER_STATUS" indexType="btree">
            <column name="status"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BANNER_SLIDER_STATUS" indexType="btree">
            <column name="slider_id"/>
            <column name="status"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BANNER_POSITION" indexType="btree">
            <column name="position"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BANNER_FT" indexType="fulltext">
            <column name="name"/>
            <column name="image"/>
            <column name="link_url"/>
        </index>
    </table>

    <!-- Banner Image Table (for responsive images) -->
    <table name="hryvinskyi_banner_slider_image" resource="default" engine="innodb"
           comment="Banner Responsive Images Table">
        <column xsi:type="int" name="image_id" unsigned="true" nullable="false" identity="true"
                comment="Image ID"/>
        <column xsi:type="int" name="banner_id" unsigned="true" nullable="false" comment="Banner ID"/>
        <column xsi:type="varchar" name="title" nullable="true" length="255" comment="Image Title"/>
        <column xsi:type="varchar" name="alt" nullable="true" length="255" comment="Image Alt Text"/>
        <column xsi:type="varchar" name="picture_media" nullable="true" length="255"
                comment="Picture Media Query (breakpoint)"/>
        <column xsi:type="smallint" name="status" unsigned="true" nullable="false" default="1"
                comment="Status"/>
        <column xsi:type="varchar" name="image" nullable="true" length="255" comment="Image Path"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="true" comment="Created At"/>
        <column xsi:type="timestamp" name="updated_at" on_update="false" nullable="true" comment="Updated At"/>

        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="image_id"/>
        </constraint>

        <constraint xsi:type="foreign" referenceId="HRYVINSKYI_BANNER_SLIDER_IMAGE_BANNER_ID"
                    table="hryvinskyi_banner_slider_image" column="banner_id"
                    referenceTable="hryvinskyi_banner_slider_banner" referenceColumn="banner_id"
                    onDelete="CASCADE"/>

        <index referenceId="HRYVINSKYI_BANNER_SLIDER_IMAGE_BANNER_ID" indexType="btree">
            <column name="banner_id"/>
        </index>
    </table>

    <!-- Breakpoint Configuration Table (per slider) -->
    <table name="hryvinskyi_banner_slider_breakpoint" resource="default" engine="innodb"
           comment="Slider Breakpoint Configuration Table">
        <column xsi:type="int" name="breakpoint_id" unsigned="true" nullable="false" identity="true"
                comment="Breakpoint ID"/>
        <column xsi:type="int" name="slider_id" unsigned="true" nullable="false" comment="Slider ID"/>
        <column xsi:type="varchar" name="name" nullable="false" length="100" comment="Display Name"/>
        <column xsi:type="varchar" name="identifier" nullable="false" length="50"
                comment="Unique Identifier (e.g., desktop, mobile)"/>
        <column xsi:type="varchar" name="media_query" nullable="false" length="255" comment="CSS Media Query"/>
        <column xsi:type="int" name="min_width" unsigned="true" nullable="false" default="0"
                comment="Minimum Viewport Width for Ordering"/>
        <column xsi:type="int" name="target_width" unsigned="true" nullable="false"
                comment="Output Image Width"/>
        <column xsi:type="int" name="target_height" unsigned="true" nullable="false"
                comment="Output Image Height"/>
        <column xsi:type="int" name="sort_order" unsigned="true" nullable="false" default="0"
                comment="Display Order"/>
        <column xsi:type="smallint" name="status" unsigned="true" nullable="false" default="1"
                comment="Status (0=Disabled, 1=Enabled)"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Created At"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Updated At"/>

        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="breakpoint_id"/>
        </constraint>

        <constraint xsi:type="foreign" referenceId="HRYVINSKYI_BANNER_SLIDER_BREAKPOINT_SLIDER_ID"
                    table="hryvinskyi_banner_slider_breakpoint" column="slider_id"
                    referenceTable="hryvinskyi_banner_slider" referenceColumn="slider_id"
                    onDelete="CASCADE"/>

        <constraint xsi:type="unique" referenceId="HRYVINSKYI_BANNER_SLIDER_BREAKPOINT_SLIDER_IDENTIFIER">
            <column name="slider_id"/>
            <column name="identifier"/>
        </constraint>

        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BREAKPOINT_SLIDER_ID" indexType="btree">
            <column name="slider_id"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BREAKPOINT_STATUS" indexType="btree">
            <column name="status"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_BREAKPOINT_SORT_ORDER" indexType="btree">
            <column name="sort_order"/>
        </index>
    </table>

    <!-- Responsive Crop Configuration Table (per banner/breakpoint) -->
    <table name="hryvinskyi_banner_slider_responsive_crop" resource="default" engine="innodb"
           comment="Banner Responsive Crop Configuration Table">
        <column xsi:type="int" name="crop_id" unsigned="true" nullable="false" identity="true"
                comment="Crop ID"/>
        <column xsi:type="int" name="banner_id" unsigned="true" nullable="false" comment="Banner ID"/>
        <column xsi:type="int" name="breakpoint_id" unsigned="true" nullable="false" comment="Breakpoint ID"/>
        <column xsi:type="varchar" name="source_image" nullable="true" length="255"
                comment="Source Image for this Crop"/>
        <column xsi:type="int" name="crop_x" unsigned="true" nullable="false" default="0"
                comment="Crop X Coordinate"/>
        <column xsi:type="int" name="crop_y" unsigned="true" nullable="false" default="0"
                comment="Crop Y Coordinate"/>
        <column xsi:type="int" name="crop_width" unsigned="true" nullable="false" default="0"
                comment="Crop Width from Source"/>
        <column xsi:type="int" name="crop_height" unsigned="true" nullable="false" default="0"
                comment="Crop Height from Source"/>
        <column xsi:type="varchar" name="cropped_image" nullable="true" length="255"
                comment="Generated Cropped Image Path"/>
        <column xsi:type="varchar" name="webp_image" nullable="true" length="255"
                comment="Generated WebP Image Path"/>
        <column xsi:type="varchar" name="avif_image" nullable="true" length="255"
                comment="Generated AVIF Image Path"/>
        <column xsi:type="boolean" name="generate_webp" nullable="false" default="true"
                comment="Flag to Generate WebP"/>
        <column xsi:type="boolean" name="generate_avif" nullable="false" default="false"
                comment="Flag to Generate AVIF"/>
        <column xsi:type="smallint" name="webp_quality" unsigned="true" nullable="false" default="85"
                comment="WebP Quality 1-100"/>
        <column xsi:type="smallint" name="avif_quality" unsigned="true" nullable="false" default="80"
                comment="AVIF Quality 1-100"/>
        <column xsi:type="int" name="sort_order" unsigned="true" nullable="false" default="0"
                comment="Sort Order (inherited from breakpoint)"/>
        <column xsi:type="smallint" name="status" unsigned="true" nullable="false" default="1"
                comment="Status (0=Disabled, 1=Enabled)"/>
        <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Created At"/>
        <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="CURRENT_TIMESTAMP"
                comment="Updated At"/>

        <constraint xsi:type="primary" referenceId="PRIMARY">
            <column name="crop_id"/>
        </constraint>

        <constraint xsi:type="foreign" referenceId="HRYVINSKYI_BANNER_SLIDER_RESP_CROP_BANNER_ID"
                    table="hryvinskyi_banner_slider_responsive_crop" column="banner_id"
                    referenceTable="hryvinskyi_banner_slider_banner" referenceColumn="banner_id"
                    onDelete="CASCADE"/>

        <constraint xsi:type="foreign" referenceId="HRYVINSKYI_BANNER_SLIDER_RESP_CROP_BREAKPOINT_ID"
                    table="hryvinskyi_banner_slider_responsive_crop" column="breakpoint_id"
                    referenceTable="hryvinskyi_banner_slider_breakpoint" referenceColumn="breakpoint_id"
                    onDelete="CASCADE"/>

        <constraint xsi:type="unique" referenceId="HRYVINSKYI_BANNER_SLIDER_RESP_CROP_BANNER_BREAKPOINT">
            <column name="banner_id"/>
            <column name="breakpoint_id"/>
        </constraint>

        <index referenceId="HRYVINSKYI_BANNER_SLIDER_RESP_CROP_BANNER_ID" indexType="btree">
            <column name="banner_id"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_RESP_CROP_BREAKPOINT_ID" indexType="btree">
            <column name="breakpoint_id"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_RESP_CROP_STATUS" indexType="btree">
            <column name="status"/>
        </index>
        <index referenceId="HRYVINSKYI_BANNER_SLIDER_RESP_CROP_BANNER_STATUS" indexType="btree">
            <column name="banner_id"/>
            <column name="status"/>
        </index>
    </table>

</schema>
